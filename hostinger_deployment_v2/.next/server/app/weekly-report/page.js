(()=>{var e={};e.id=6450,e.ids=[6450],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1017:e=>{"use strict";e.exports=require("path")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},6669:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>m,originalPathname:()=>p,pages:()=>c,routeModule:()=>f,tree:()=>d});var s=r(7096),i=r(6132),n=r(7284),o=r.n(n),a=r(2564),l={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);r.d(t,l);let d=["",{children:["weekly-report",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,389)),"/Users/swumpyaesone/Documents/project_management/hostinger_deployment_v2/src/app/weekly-report/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,2540)),"/Users/swumpyaesone/Documents/project_management/hostinger_deployment_v2/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/swumpyaesone/Documents/project_management/hostinger_deployment_v2/src/app/weekly-report/page.tsx"],p="/weekly-report/page",m={require:r,loadChunk:()=>Promise.resolve()},f=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/weekly-report/page",pathname:"/weekly-report",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},4751:(e,t,r)=>{Promise.resolve().then(r.bind(r,9558))},9558:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var s=r(3854),i=r(4218),n=r(1018),o=r(6837),a=r(6965),l=r(8041),d=r(7689),c=r(4358),p=r(1843),m=r(856),f=r(9077);function g(){let{user:e,isAuthenticated:t,isLoading:g}=(0,o.useAuth)(),u=(0,n.useRouter)(),[x,h]=(0,i.useState)([]),[y,b]=(0,i.useState)([]),[j,w]=(0,i.useState)([]),[v,k]=(0,i.useState)(!0),[_,S]=(0,i.useState)(""),[R,C]=(0,i.useState)(new Set),[W,E]=(0,i.useState)(null),[P,z]=(0,i.useState)(!1),[A,q]=(0,i.useState)(!1),[L,I]=(0,i.useState)(null),[M,T]=(0,i.useState)({keyActivities:[""],ongoingTasks:[""],challenges:[""],teamPerformance:[""],nextWeekPriorities:[""],otherNotes:""}),[Z,B]=(0,i.useState)("user");(0,i.useEffect)(()=>{if(g)return;if(!t){u.push("/login");return}console.log("User role detection:",{user:e,role:e?.role,userMetadata:e?.user_metadata});let r=e?.role||e?.user_metadata?.role;"hr"===r||"admin"===r?(console.log("Setting admin view mode for role:",r),B("admin")):(console.log("Setting user view mode for role:",r),B("user")),D()},[t,g,u,e]),(0,i.useEffect)(()=>{t&&!g&&e&&(console.log("View mode changed, re-fetching data. Mode:",Z),D())},[Z]);let D=async()=>{try{k(!0);let t=(await Promise.resolve().then(r.bind(r,2132))).supabase;if("user"===Z){let{data:r,error:s}=await t.from("weekly_reports").select("*").eq("employee_id",e?.id).order("created_at",{ascending:!1});if(s)throw s;h(r||[])}else{console.log("Admin/HR user - fetching reports from accessible team members");let{data:r,error:s}=await t.from("projects_project_members").select("project_id").eq("user_id",e?.id);if(s)throw console.error("User projects fetch error:",s),s;let i=r?.map(e=>e.project_id)||[];if(console.log("User accessible projects:",i),0===i.length){h([]),w([]),b([]);return}let{data:n,error:o}=await t.from("projects_project_members").select(`
            user_id,
            auth_user!inner(id, name, email, role)
          `).in("project_id",i);if(o)throw console.error("Accessible members fetch error:",o),o;let a=[...new Set(n?.map(e=>e.user_id)||[])],l=n?.map(e=>e.auth_user).filter(Boolean)||[];if(console.log("Accessible team members:",a.length),0===a.length){h([]),w([]),b([]);return}let{data:d,error:c}=await t.from("weekly_reports").select("*").in("employee_id",a).order("year",{ascending:!1}).order("week_number",{ascending:!1});if(c)throw console.error("Filtered reports fetch error:",c),c;console.log("Admin view - Filtered reports from accessible team members:",d?.length||0),console.log("Admin view - Accessible team members count:",l.length),h(d||[]),w(l),F(d||[],l)}}catch(e){console.error("Error fetching data:",e),S("Failed to load weekly reports")}finally{k(!1)}},F=(e,t)=>{let r=new Map;e.forEach(e=>{let t=`${e.year}-${e.week_number}`;r.has(t)||r.set(t,[]),r.get(t).push(e)});let s=[];r.forEach((e,r)=>{let[i,n]=r.split("-").map(Number),o=e[0];s.push({weekNumber:n,year:i,dateRangeDisplay:o.date_range_display,reports:e,totalEmployees:t.length,submittedCount:new Set(e.map(e=>e.employee_id)).size})}),s.sort((e,t)=>e.year!==t.year?t.year-e.year:t.weekNumber-e.weekNumber),b(s)},N=e=>{let t=new Set(R);t.has(e)?t.delete(e):t.add(e),C(t)},H=e=>{E(e),z(!0)},U=e=>{I(e);let t=e=>{if(!e)return[""];let t=e.replace(/^â€¢\s*/gm,"").split("\n").filter(e=>e.trim());return t.length>0?t:[""]};T({keyActivities:t(e.key_activities),ongoingTasks:t(e.ongoing_tasks),challenges:t(e.challenges),teamPerformance:t(e.team_performance),nextWeekPriorities:t(e.next_week_priorities),otherNotes:e.other_notes||""}),q(!0)},G=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return g||v?(0,s.jsxs)("div",{style:{display:"flex",minHeight:"100vh",background:"#F5F5ED"},children:[s.jsx(f.Z,{projects:[],onCreateProject:()=>{}}),s.jsx("div",{style:{marginLeft:"256px",padding:"2rem",background:"#F5F5ED",flex:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh"},children:s.jsx("div",{style:{width:"32px",height:"32px",border:"3px solid #C483D9",borderTop:"3px solid #5884FD",borderRadius:"50%",animation:"spin 1s linear infinite"}})})]}):t?(0,s.jsxs)(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:`
          @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }
        `}}),(0,s.jsxs)("div",{style:{display:"flex",minHeight:"100vh",background:"#fafafa"},children:[s.jsx(f.Z,{projects:[],onCreateProject:()=>{}}),(0,s.jsxs)("div",{style:{marginLeft:"256px",padding:"2rem",background:"#fafafa",flex:1,minHeight:"100vh"},children:[s.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"3rem",paddingBottom:"1.5rem"},children:(0,s.jsxs)("div",{children:[s.jsx("h1",{style:{fontSize:"2.5rem",fontWeight:"300",margin:"0",color:"#111827",letterSpacing:"-0.02em"},children:"Weekly Reports"}),s.jsx("p",{style:{fontSize:"1.1rem",color:"#6b7280",margin:"0.5rem 0 0 0",lineHeight:"1.5"},children:"admin"===Z?"Team weekly progress reports and insights":"Your weekly progress reports and achievements"})]})}),_&&s.jsx("div",{style:{background:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px",padding:"1rem",marginBottom:"2rem",color:"#dc2626",fontWeight:"500",fontSize:"0.875rem"},children:_}),"admin"===Z?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem",marginBottom:"3rem"},children:[(0,s.jsxs)("div",{style:{background:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"12px",padding:"2rem",textAlign:"center",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[s.jsx("div",{style:{fontSize:"2.5rem",fontWeight:"300",color:"#111827",marginBottom:"0.5rem"},children:y.length}),s.jsx("div",{style:{color:"#6b7280",fontSize:"0.875rem",fontWeight:"500"},children:"Total Weeks"})]}),(0,s.jsxs)("div",{style:{background:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"12px",padding:"2rem",textAlign:"center",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[s.jsx("div",{style:{fontSize:"2.5rem",fontWeight:"300",color:"#111827",marginBottom:"0.5rem"},children:x.length}),s.jsx("div",{style:{color:"#6b7280",fontSize:"0.875rem",fontWeight:"500"},children:"Total Reports"})]}),(0,s.jsxs)("div",{style:{background:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"12px",padding:"2rem",textAlign:"center",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[s.jsx("div",{style:{fontSize:"2.5rem",fontWeight:"300",color:"#111827",marginBottom:"0.5rem"},children:j.length}),s.jsx("div",{style:{color:"#6b7280",fontSize:"0.875rem",fontWeight:"500"},children:"Team Members"})]})]}),s.jsx("div",{style:{background:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"12px",overflow:"hidden",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:0===y.length?(0,s.jsxs)("div",{style:{textAlign:"center",padding:"4rem 2rem",color:"#9ca3af"},children:[s.jsx("div",{style:{width:"64px",height:"64px",background:"#f3f4f6",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 2rem"},children:s.jsx(a.Z,{style:{width:"32px",height:"32px",color:"#9ca3af"}})}),s.jsx("h3",{style:{fontSize:"1.5rem",fontWeight:"400",margin:"0 0 1rem 0",color:"#111827",letterSpacing:"-0.01em"},children:"No Weekly Reports Yet"}),s.jsx("p",{style:{fontSize:"1.1rem",margin:"0",lineHeight:"1.5"},children:"Weekly reports from your team will appear here when they're submitted."})]}):s.jsx("div",{style:{padding:"1.5rem"},children:y.map(t=>{let r=`${t.year}-${t.weekNumber}`,i=R.has(r),n=Math.round(t.submittedCount/t.totalEmployees*100);return(0,s.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,s.jsxs)("div",{onClick:()=>N(r),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"1.5rem",background:"#111827",color:"#ffffff",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s ease",marginBottom:i?"1rem":"0"},onMouseEnter:e=>{e.currentTarget.style.background="#1f2937"},onMouseLeave:e=>{e.currentTarget.style.background="#111827"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[i?s.jsx(l.Z,{style:{width:"20px",height:"20px"}}):s.jsx(d.Z,{style:{width:"20px",height:"20px"}}),s.jsx(c.Z,{style:{width:"24px",height:"24px"}})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{style:{fontSize:"1.1rem",fontWeight:"500"},children:["Week ",t.weekNumber,", ",t.year]}),s.jsx("div",{style:{fontSize:"0.9rem",opacity:.9},children:t.dateRangeDisplay})]})]}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1.5rem"},children:[(0,s.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.2)",padding:"0.5rem 1rem",borderRadius:"6px",fontSize:"0.875rem",fontWeight:"500"},children:[t.submittedCount,"/",t.totalEmployees," submitted (",n,"%)"]}),s.jsx("div",{style:{background:"#6b7280",padding:"0.25rem 0.75rem",borderRadius:"12px",fontSize:"0.75rem",fontWeight:"600",color:"#ffffff"},children:100===n?"Complete":n>=50?"In Progress":"Pending"})]})]}),i&&s.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:"8px",padding:"1.5rem"},children:t.reports.length>0?s.jsx("div",{style:{display:"grid",gap:"1rem"},children:t.reports.map(t=>(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"1rem",background:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"6px",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.1)"},onMouseLeave:e=>{e.currentTarget.style.boxShadow="none"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[s.jsx("div",{style:{width:"40px",height:"40px",background:"#111827",color:"#ffffff",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"500"},children:t.employee_name.charAt(0).toUpperCase()}),(0,s.jsxs)("div",{children:[s.jsx("div",{style:{fontWeight:"500",color:"#111827"},children:t.employee_name}),s.jsx("div",{style:{fontSize:"0.85rem",color:"#6b7280"},children:t.project_name})]})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[s.jsx("button",{onClick:()=>H(t),style:{padding:"0.5rem",background:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"6px",cursor:"pointer",color:"#374151",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center"},title:"View report",children:s.jsx(p.Z,{style:{width:"16px",height:"16px"}})}),t.employee_id===e?.id&&s.jsx("button",{onClick:()=>U(t),style:{padding:"0.5rem",background:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"6px",cursor:"pointer",color:"#6b7280",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center"},title:"Edit report",children:s.jsx(m.Z,{style:{width:"16px",height:"16px"}})})]})]},t.id))}):s.jsx("div",{style:{textAlign:"center",color:"#6b7280",padding:"2rem"},children:"No reports submitted for this week yet."})})]},r)})})})]}):s.jsx("div",{style:{background:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"12px",overflow:"hidden",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:0===x.length?(0,s.jsxs)("div",{style:{textAlign:"center",padding:"4rem 2rem",color:"#9ca3af"},children:[s.jsx("div",{style:{width:"64px",height:"64px",background:"#f3f4f6",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 2rem"},children:s.jsx(a.Z,{style:{width:"32px",height:"32px",color:"#9ca3af"}})}),s.jsx("h3",{style:{fontSize:"1.5rem",fontWeight:"400",margin:"0 0 1rem 0",color:"#111827",letterSpacing:"-0.01em"},children:"No Weekly Reports Yet"}),s.jsx("p",{style:{fontSize:"1.1rem",margin:"0",lineHeight:"1.5"},children:"Your weekly reports will appear here once you start submitting them."})]}):s.jsx("div",{style:{padding:"1.5rem"},children:x.map(e=>(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"1.5rem",marginBottom:"1rem",background:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",transition:"all 0.2s ease",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 1px 3px rgba(0, 0, 0, 0.1)"},children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{style:{fontSize:"1.1rem",fontWeight:"500",color:"#111827",marginBottom:"0.5rem"},children:["Week ",e.week_number,", ",e.year]}),s.jsx("div",{style:{fontSize:"0.9rem",color:"#6b7280",marginBottom:"0.25rem"},children:e.date_range_display}),(0,s.jsxs)("div",{style:{fontSize:"0.85rem",color:"#9ca3af"},children:[e.project_name," â€¢ Submitted ",G(e.created_at)]})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,s.jsxs)("button",{onClick:()=>H(e),style:{padding:"0.75rem 1.5rem",background:"#111827",color:"#ffffff",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.875rem",fontWeight:"500",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"0.5rem"},children:[s.jsx(p.Z,{style:{width:"16px",height:"16px"}}),"View"]}),(0,s.jsxs)("button",{onClick:()=>U(e),style:{padding:"0.75rem 1.5rem",background:"#ffffff",color:"#6b7280",border:"1px solid #e5e7eb",borderRadius:"6px",cursor:"pointer",fontSize:"0.875rem",fontWeight:"500",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"0.5rem"},children:[s.jsx(m.Z,{style:{width:"16px",height:"16px"}}),"Edit"]})]})]},e.id))})})]})]})]}):null}},389:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>o,__esModule:()=>n,default:()=>l});var s=r(5153);let i=(0,s.createProxy)(String.raw`/Users/swumpyaesone/Documents/project_management/hostinger_deployment_v2/src/app/weekly-report/page.tsx`),{__esModule:n,$$typeof:o}=i,a=i.default,l=a},7689:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(4218);let i=s.forwardRef(function({title:e,titleId:t,...r},i){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},r),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))}),n=i},1843:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(4218);let i=s.forwardRef(function({title:e,titleId:t,...r},i){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},r),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}),n=i},856:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(4218);let i=s.forwardRef(function({title:e,titleId:t,...r},i){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},r),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}),n=i}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[3271,9101,1323,7490,5446,4598,6097],()=>r(6669));module.exports=s})();