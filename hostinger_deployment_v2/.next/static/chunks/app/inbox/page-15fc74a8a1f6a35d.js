(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6840],{5525:function(e,t,r){Promise.resolve().then(r.bind(r,4512))},4512:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var i=r(7437),n=r(2265),o=r(4033),a=r(3549),s=r(5838),l=r(9186),d=r(2893),c=r(7965),u=r(4438),f=r(9367);function p(){let{user:e,isAuthenticated:t,isLoading:p}=(0,a.useAuth)(),m=(0,o.useRouter)(),[g,h]=(0,n.useState)([]),[x,b]=(0,n.useState)(!0),[v,y]=(0,n.useState)(""),[w,j]=(0,n.useState)("all");(0,n.useEffect)(()=>{if(!p){if(!t){m.push("/login");return}k()}},[t,p,m,e]);let k=async()=>{if(null==e?void 0:e.id)try{b(!0);let t=(await Promise.resolve().then(r.bind(r,8411))).supabase,{data:i,error:n}=await t.from("notifications").select("*").eq("recipient_id",e.id).order("created_at",{ascending:!1});if(n)throw n;h(i||[])}catch(e){console.error("Error fetching notifications:",e),y("Failed to load notifications")}finally{b(!1)}},_=async e=>{try{let t=(await Promise.resolve().then(r.bind(r,8411))).supabase,{error:i}=await t.from("notifications").update({is_read:!0}).eq("id",e);if(i)throw i;h(g.map(t=>t.id===e?{...t,is_read:!0}:t))}catch(e){console.error("Error marking notification as read:",e)}},S=async()=>{try{let e=(await Promise.resolve().then(r.bind(r,8411))).supabase,t=g.filter(e=>!e.is_read).map(e=>e.id);if(0===t.length)return;let{error:i}=await e.from("notifications").update({is_read:!0}).in("id",t);if(i)throw i;h(g.map(e=>({...e,is_read:!0})))}catch(e){console.error("Error marking all notifications as read:",e)}},E=e=>{switch(e){case"leave_request_submitted":return(0,i.jsx)(s.Z,{style:{width:"20px",height:"20px",color:"#FFB333"}});case"leave_request_approved":return(0,i.jsx)(l.Z,{style:{width:"20px",height:"20px",color:"#10b981"}});case"leave_request_rejected":return(0,i.jsx)(d.Z,{style:{width:"20px",height:"20px",color:"#F87239"}});default:return(0,i.jsx)(c.Z,{style:{width:"20px",height:"20px",color:"#C483D9"}})}},L=e=>{let t=new Date(e),r=new Date,i=(r.getTime()-t.getTime())/36e5;return i<1?"Just now":i<24?"".concat(Math.floor(i),"h ago"):i<48?"Yesterday":t.toLocaleDateString()},R="unread"===w?g.filter(e=>!e.is_read):g;return p||x?(0,i.jsx)("div",{style:{padding:"2rem",background:"#F5F5ED",flex:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh"},children:(0,i.jsx)("div",{style:{width:"32px",height:"32px",border:"3px solid #C483D9",borderTop:"3px solid #5884FD",borderRadius:"50%",animation:"spin 1s linear infinite"}})}):t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n          @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n          }\n        "}}),(0,i.jsxs)("div",{style:{padding:"2rem",background:"#F5F5ED",flex:1,minHeight:"100vh"},children:[(0,i.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"3rem",paddingBottom:"1.5rem"},children:(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{style:{fontSize:"2.5rem",fontWeight:"300",margin:"0",color:"#1a1a1a",letterSpacing:"-0.02em"},children:"Inbox"}),(0,i.jsx)("p",{style:{fontSize:"1.1rem",color:"#666666",margin:"0.5rem 0 0 0",lineHeight:"1.5"},children:"Notifications and important updates"})]})}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem",marginBottom:"3rem"},children:[(0,i.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"16px",padding:"2rem",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)"},children:[(0,i.jsx)("div",{style:{fontSize:"2.5rem",fontWeight:"300",color:"#5884FD",marginBottom:"0.5rem"},children:g.length}),(0,i.jsx)("div",{style:{color:"#666666",fontSize:"0.9rem",fontWeight:"500"},children:"Total Notifications"})]}),(0,i.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"16px",padding:"2rem",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)"},children:[(0,i.jsx)("div",{style:{fontSize:"2.5rem",fontWeight:"300",color:"#FFB333",marginBottom:"0.5rem"},children:g.filter(e=>!e.is_read).length}),(0,i.jsx)("div",{style:{color:"#666666",fontSize:"0.9rem",fontWeight:"500"},children:"Unread"})]}),(0,i.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"16px",padding:"2rem",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)"},children:[(0,i.jsx)("div",{style:{fontSize:"2.5rem",fontWeight:"300",color:"#10b981",marginBottom:"0.5rem"},children:g.filter(e=>e.is_read).length}),(0,i.jsx)("div",{style:{color:"#666666",fontSize:"0.9rem",fontWeight:"500"},children:"Read"})]})]}),(0,i.jsx)("div",{style:{background:"#ffffff",border:"1px solid #e8e8e8",borderRadius:"16px",padding:"2rem",marginBottom:"2rem",boxShadow:"0 2px 16px rgba(0, 0, 0, 0.04)"},children:(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"1rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",gap:"0.75rem"},children:[(0,i.jsxs)("button",{onClick:()=>j("all"),style:{padding:"0.75rem 1.5rem",background:"all"===w?"#5884FD":"#ffffff",color:"all"===w?"#ffffff":"#666666",border:"1px solid #e0e0e0",borderRadius:"12px",fontSize:"0.9rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"all"===w?"0 4px 12px rgba(88, 132, 253, 0.3)":"0 2px 8px rgba(0, 0, 0, 0.1)"},children:["All (",g.length,")"]}),(0,i.jsxs)("button",{onClick:()=>j("unread"),style:{padding:"0.75rem 1.5rem",background:"unread"===w?"#5884FD":"#ffffff",color:"unread"===w?"#ffffff":"#666666",border:"1px solid #e0e0e0",borderRadius:"12px",fontSize:"0.9rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"unread"===w?"0 4px 12px rgba(88, 132, 253, 0.3)":"0 2px 8px rgba(0, 0, 0, 0.1)"},children:["Unread (",g.filter(e=>!e.is_read).length,")"]})]}),g.some(e=>!e.is_read)&&(0,i.jsx)("button",{onClick:S,style:{padding:"0.75rem 1.5rem",background:"#FFB333",color:"#ffffff",border:"none",borderRadius:"12px",fontSize:"0.9rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 4px 12px rgba(255, 179, 51, 0.3)"},children:"Mark All as Read"})]})}),v&&(0,i.jsx)("div",{style:{background:"#ffffff",border:"1px solid #F87239",borderRadius:"12px",padding:"1rem",marginBottom:"2rem",color:"#F87239",fontWeight:"500",boxShadow:"0 2px 8px rgba(248, 114, 57, 0.1)"},children:v}),(0,i.jsx)("div",{style:{background:"#ffffff",border:"1px solid #e8e8e8",borderRadius:"16px",overflow:"hidden",boxShadow:"0 2px 16px rgba(0, 0, 0, 0.04)"},children:0===R.length?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"4rem 2rem",color:"#999999"},children:[(0,i.jsx)("div",{style:{width:"64px",height:"64px",background:"#f0f0f0",borderRadius:"16px",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 2rem"},children:(0,i.jsx)(u.Z,{style:{width:"32px",height:"32px",color:"#999999"}})}),(0,i.jsx)("h3",{style:{fontSize:"1.5rem",fontWeight:"400",margin:"0 0 1rem 0",color:"#1a1a1a",letterSpacing:"-0.01em"},children:"unread"===w?"No Unread Notifications":"No Notifications"}),(0,i.jsx)("p",{style:{fontSize:"1.1rem",margin:"0",lineHeight:"1.5"},children:"unread"===w?"All caught up! No unread notifications at the moment.":"Your inbox is empty. Notifications will appear here when you have updates."})]}):(0,i.jsx)("div",{style:{padding:"1.5rem"},children:R.map(e=>(0,i.jsxs)("div",{onClick:()=>!e.is_read&&_(e.id),style:{display:"flex",alignItems:"flex-start",gap:"1.5rem",padding:"1.5rem",marginBottom:"1rem",background:e.is_read?"#ffffff":"#f8fafc",border:"1px solid ".concat(e.is_read?"#e8e8e8":"#5884FD"),borderRadius:"12px",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.04)"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 16px rgba(0, 0, 0, 0.1)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.04)"},children:[(0,i.jsx)("div",{style:{width:"48px",height:"48px",background:"#f0f0f0",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:E(e.type)}),(0,i.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,i.jsx)("div",{style:{fontSize:"1.1rem",fontWeight:"500",color:"#1a1a1a",marginBottom:"0.5rem",lineHeight:"1.4"},children:e.title}),(0,i.jsx)("div",{style:{fontSize:"0.95rem",color:"#666666",lineHeight:"1.5",marginBottom:"1rem"},children:e.message}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"0.85rem",color:"#999999"},children:[(0,i.jsx)("span",{children:L(e.created_at)}),!e.is_read&&(0,i.jsx)("button",{onClick:t=>{t.stopPropagation(),_(e.id)},style:{background:"transparent",border:"none",color:"#5884FD",cursor:"pointer",padding:"0.25rem",borderRadius:"6px",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"0.25rem"},title:"Mark as read",children:(0,i.jsx)(f.Z,{style:{width:"16px",height:"16px"}})})]})]})]},e.id))})})]})]}):null}},3549:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return l},useAuth:function(){return s}});var i=r(7437),n=r(2265),o=r(8411);let a=(0,n.createContext)(void 0),s=()=>{let e=(0,n.useContext)(a);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},l=e=>{let{children:t}=e,[r,s]=(0,n.useState)(null),[l,d]=(0,n.useState)(!0),[c,u]=(0,n.useState)(!1);(0,n.useEffect)(()=>{u(!0)},[]),(0,n.useEffect)(()=>{if(!c)return;let e=async()=>{try{console.log("Starting auth initialization..."),await new Promise(e=>setTimeout(e,50));let{user:n,error:a}=await o.supabaseAuth.getUser();if(console.log("Auth result:",{currentUser:n,error:a}),n&&!a){var e,t,r,i;let o={id:n.id,email:n.email,name:(null===(e=n.user_metadata)||void 0===e?void 0:e.name)||n.email,phone:(null===(t=n.user_metadata)||void 0===t?void 0:t.phone)||"",role:(null===(r=n.user_metadata)||void 0===r?void 0:r.role)||"member",position:(null===(i=n.user_metadata)||void 0===i?void 0:i.position)||"",date_joined:new Date().toISOString()};s(o),console.log("User set:",o)}else console.log("No user found or error occurred")}catch(e){console.error("Auth initialization error:",e)}finally{console.log("Setting isLoading to false"),d(!1)}},t=setTimeout(()=>{console.warn("Auth initialization timeout, proceeding without auth"),d(!1)},3e3),r=setTimeout(()=>{e().finally(()=>{clearTimeout(t)})},100);return()=>{clearTimeout(t),clearTimeout(r)}},[c]);let f=async(e,t)=>{try{console.log("Attempting login for:",e);let{user:l,error:d}=await o.supabaseAuth.signIn(e,t);if(d)throw console.error("Login error:",d),Error(d instanceof Error?d.message:"Login failed");if(l){var r,i,n,a;let e={id:l.id,email:l.email,name:(null===(r=l.user_metadata)||void 0===r?void 0:r.name)||l.email,phone:(null===(i=l.user_metadata)||void 0===i?void 0:i.phone)||"",role:(null===(n=l.user_metadata)||void 0===n?void 0:n.role)||"member",position:(null===(a=l.user_metadata)||void 0===a?void 0:a.position)||"",date_joined:new Date().toISOString()};s(e),console.log("Login successful:",e)}}catch(e){throw console.error("Login failed:",e),Error(e.message||"Login failed")}},p=async e=>{throw Error("Registration is disabled. Please contact an administrator.")},m=async()=>{try{await o.supabaseAuth.signOut(),s(null)}catch(e){console.error("Logout error:",e),s(null)}};return(0,i.jsx)(a.Provider,{value:{user:r,isLoading:l,login:f,register:p,logout:m,isAuthenticated:!!r},children:t})}},622:function(e,t,r){"use strict";var i=r(2265),n=Symbol.for("react.element"),o=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function d(e,t,r){var i,o={},d=null,c=null;for(i in void 0!==r&&(d=""+r),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(c=t.ref),t)a.call(t,i)&&!l.hasOwnProperty(i)&&(o[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===o[i]&&(o[i]=t[i]);return{$$typeof:n,type:e,key:d,ref:c,props:o,_owner:s.current}}t.Fragment=o,t.jsx=d,t.jsxs=d},7437:function(e,t,r){"use strict";e.exports=r(622)},4033:function(e,t,r){e.exports=r(94)},7965:function(e,t,r){"use strict";var i=r(2265);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))});t.Z=n},9186:function(e,t,r){"use strict";var i=r(2265);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))});t.Z=n},5838:function(e,t,r){"use strict";var i=r(2265);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"}))});t.Z=n},9367:function(e,t,r){"use strict";var i=r(2265);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))});t.Z=n},4438:function(e,t,r){"use strict";var i=r(2265);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 13.5h3.86a2.25 2.25 0 0 1 2.012 1.244l.256.512a2.25 2.25 0 0 0 2.013 1.244h3.218a2.25 2.25 0 0 0 2.013-1.244l.256-.512a2.25 2.25 0 0 1 2.013-1.244h3.859m-19.5.338V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18v-4.162c0-.224-.034-.447-.1-.661L19.24 5.338a2.25 2.25 0 0 0-2.15-1.588H6.911a2.25 2.25 0 0 0-2.15 1.588L2.35 13.177a2.25 2.25 0 0 0-.1.661Z"}))});t.Z=n},2893:function(e,t,r){"use strict";var i=r(2265);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))});t.Z=n}},function(e){e.O(0,[7708,8411,2971,2472,1744],function(){return e(e.s=5525)}),_N_E=e.O()}]);