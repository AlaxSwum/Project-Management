(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[322],{1022:function(e,s,r){Promise.resolve().then(r.bind(r,4787))},4787:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return t}});var i=r(7437),l=r(2265);function t(){let[e,s]=(0,l.useState)(null),[r,t]=(0,l.useState)(null),[n,d]=(0,l.useState)(null),[a,o]=(0,l.useState)(!1),c=async()=>{o(!0);try{let e=await fetch("/api/google-drive-proxy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"testAuth"})}),r=await e.json();s(r),console.log("\uD83D\uDD0D Test Auth Result:",r)}catch(e){console.error("❌ Test Auth Error:",e),s({error:e instanceof Error?e.message:String(e)})}finally{o(!1)}},h=async()=>{o(!0);try{let e=await fetch("/api/google-drive-proxy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"listFiles",folderId:"root"})}),s=await e.json();t(s),console.log("\uD83D\uDD0D List Files Result:",s)}catch(e){console.error("❌ List Files Error:",e),t({error:e instanceof Error?e.message:String(e)})}finally{o(!1)}},x=async()=>{o(!0);try{let e=await fetch("/api/google-drive-proxy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"listSharedDrives"})}),s=await e.json();d(s),console.log("\uD83D\uDD0D Shared Drives Result:",s)}catch(e){console.error("❌ Shared Drives Error:",e),d({error:e instanceof Error?e.message:String(e)})}finally{o(!1)}};return(0,i.jsx)("div",{className:"min-h-screen p-8 bg-gray-50",children:(0,i.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[(0,i.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"\uD83D\uDD0D Google Drive API Debug"}),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"p-6 bg-blue-50 rounded-lg",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Test Authentication"}),(0,i.jsx)("button",{onClick:c,disabled:a,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:a?"Testing...":"Test Service Account Auth"}),e&&(0,i.jsxs)("div",{className:"mt-4 p-4 bg-white rounded border",children:[(0,i.jsx)("h3",{className:"font-semibold mb-2",children:"Auth Test Result:"}),(0,i.jsx)("pre",{className:"text-sm overflow-auto",children:JSON.stringify(e,null,2)})]})]}),(0,i.jsxs)("div",{className:"p-6 bg-green-50 rounded-lg",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Test List Files"}),(0,i.jsx)("button",{onClick:h,disabled:a,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50",children:a?"Testing...":"Test List Root Files"}),r&&(0,i.jsxs)("div",{className:"mt-4 p-4 bg-white rounded border",children:[(0,i.jsx)("h3",{className:"font-semibold mb-2",children:"List Files Result:"}),(0,i.jsx)("pre",{className:"text-sm overflow-auto",children:JSON.stringify(r,null,2)})]})]}),(0,i.jsxs)("div",{className:"p-6 bg-purple-50 rounded-lg",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Test List Shared Drives"}),(0,i.jsx)("button",{onClick:x,disabled:a,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50",children:a?"Testing...":"List Available Shared Drives"}),n&&(0,i.jsxs)("div",{className:"mt-4 p-4 bg-white rounded border",children:[(0,i.jsx)("h3",{className:"font-semibold mb-2",children:"Shared Drives Result:"}),(0,i.jsx)("pre",{className:"text-sm overflow-auto",children:JSON.stringify(n,null,2)}),n.drives&&n.drives.length>0&&(0,i.jsxs)("div",{className:"mt-2 text-green-600",children:["✅ Found ",n.drives.length," shared drive(s) - uploads should work in these!"]}),n.drives&&0===n.drives.length&&(0,i.jsx)("div",{className:"mt-2 text-red-600",children:"❌ No shared drives found - you need to create shared drives for uploads to work"})]})]}),(0,i.jsxs)("div",{className:"p-6 bg-red-50 border-l-4 border-red-400 rounded-lg",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-red-800 mb-4",children:"⚠️ Upload Issue Identified"}),(0,i.jsxs)("div",{className:"text-sm text-red-700 space-y-3",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Problem:"}),' "Internal Server Error" when uploading files']}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Root Cause:"})," Service accounts cannot upload to regular Google Drive folders due to storage quota limitations"]}),(0,i.jsxs)("div",{className:"bg-red-100 p-3 rounded border",children:[(0,i.jsx)("p",{children:(0,i.jsx)("strong",{children:"Google API Error:"})}),(0,i.jsx)("code",{className:"text-xs",children:"Service Accounts do not have storage quota. Use shared drives instead."})]})]})]}),(0,i.jsxs)("div",{className:"p-6 bg-green-50 border-l-4 border-green-400 rounded-lg",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-green-800 mb-4",children:"✅ Solution: Use Google Shared Drives"}),(0,i.jsxs)("div",{className:"text-sm text-green-700 space-y-3",children:[(0,i.jsx)("p",{children:(0,i.jsx)("strong",{children:"Service Account Email:"})}),(0,i.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded text-gray-900",children:"projectmanagement@projectmanagement-463423.iam.gserviceaccount.com"}),(0,i.jsx)("p",{className:"mt-4",children:(0,i.jsx)("strong",{children:"Step-by-Step Fix:"})}),(0,i.jsxs)("ol",{className:"list-decimal list-inside space-y-2",children:[(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Create a Shared Drive:"}),(0,i.jsxs)("ul",{className:"list-disc list-inside ml-4 mt-1 space-y-1",children:[(0,i.jsxs)("li",{children:["Go to ",(0,i.jsx)("a",{href:"https://drive.google.com",target:"_blank",className:"text-blue-600 underline",children:"Google Drive"})]}),(0,i.jsx)("li",{children:'Click "New" → "Shared drive"'}),(0,i.jsx)("li",{children:'Name it (e.g., "Project Management Files")'}),(0,i.jsx)("li",{children:'Click "Create"'})]})]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Add Service Account to Shared Drive:"}),(0,i.jsxs)("ul",{className:"list-disc list-inside ml-4 mt-1 space-y-1",children:[(0,i.jsx)("li",{children:"Open your new shared drive"}),(0,i.jsx)("li",{children:'Right-click → "Manage members"'}),(0,i.jsx)("li",{children:'Click "Add members"'}),(0,i.jsxs)("li",{children:["Add: ",(0,i.jsx)("code",{className:"bg-gray-100 px-1 rounded",children:"projectmanagement@projectmanagement-463423.iam.gserviceaccount.com"})]}),(0,i.jsxs)("li",{children:["Set permission to ",(0,i.jsx)("strong",{children:'"Manager"'})," or ",(0,i.jsx)("strong",{children:'"Content manager"'})]}),(0,i.jsx)("li",{children:'Click "Send"'})]})]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Create Folders in Shared Drive:"}),(0,i.jsxs)("ul",{className:"list-disc list-inside ml-4 mt-1 space-y-1",children:[(0,i.jsx)("li",{children:'Create folders like "Operations", "Marketing", etc. inside the shared drive'}),(0,i.jsx)("li",{children:"These folders will now support file uploads from the service account"})]})]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Test:"}),' Use the "List Available Shared Drives" button above to verify setup']})]}),(0,i.jsxs)("div",{className:"bg-green-100 p-3 rounded border mt-4",children:[(0,i.jsx)("p",{children:(0,i.jsx)("strong",{children:"\uD83D\uDCA1 Why This Works:"})}),(0,i.jsx)("p",{className:"text-xs",children:"Shared drives have their own storage quota and allow service accounts to upload files, unlike regular Google Drive folders which are tied to individual user accounts."})]})]})]}),(0,i.jsxs)("div",{className:"p-6 bg-yellow-50 rounded-lg",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"\uD83D\uDCC2 For File Browsing (Already Working)"}),(0,i.jsxs)("div",{className:"text-sm text-gray-700 space-y-2",children:[(0,i.jsx)("p",{children:(0,i.jsx)("strong",{children:"To share regular folders for browsing only:"})}),(0,i.jsxs)("ol",{className:"list-decimal list-inside space-y-1",children:[(0,i.jsx)("li",{children:"Share your Google Drive folders with the service account email above"}),(0,i.jsx)("li",{children:'Set permission to "Editor" when sharing'}),(0,i.jsx)("li",{children:"The service account can see and list these folders (but cannot upload to them)"})]})]})]})]})]})})})}}},function(e){e.O(0,[736,744],function(){return e(e.s=1022)}),_N_E=e.O()}]);