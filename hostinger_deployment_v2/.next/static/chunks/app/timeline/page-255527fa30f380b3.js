(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8571],{6098:function(e,t,i){Promise.resolve().then(i.bind(i,2938))},2938:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return f}});var n=i(7437),r=i(2265),o=i(4033),l=i(3549),d=i(4541),a=i(1205),s=i(5255),p=i(13),c=i(3217),x=i(9649),g=i(654),h=i(4164),u=i(2601);let m=(0,d.eI)(u.env.NEXT_PUBLIC_SUPABASE_URL,u.env.NEXT_PUBLIC_SUPABASE_ANON_KEY);function f(){let{user:e,isAuthenticated:t,isLoading:i}=(0,l.useAuth)(),d=(0,o.useRouter)(),[u,f]=(0,r.useState)([]),[y,b]=(0,r.useState)(null),[v,j]=(0,r.useState)([]),[_,w]=(0,r.useState)([]),[B,E]=(0,r.useState)([]),[k,S]=(0,r.useState)(!0),[C,D]=(0,r.useState)(""),[F,z]=(0,r.useState)(""),[A,W]=(0,r.useState)(!1),[R,I]=(0,r.useState)("month"),[M,T]=(0,r.useState)(new Date),[L,P]=(0,r.useState)(!0),[O,q]=(0,r.useState)(!1),[Z,N]=(0,r.useState)(!1),[Y,U]=(0,r.useState)(!1),[H,$]=(0,r.useState)(!1),[V,X]=(0,r.useState)(!1),[K,Q]=(0,r.useState)(!1),[G,J]=(0,r.useState)({name:"",description:"",start_date:"",end_date:"",total_budget:0,currency:"USD"}),[ee,et]=(0,r.useState)({name:"",description:"",color:"#3B82F6",responsible_person_id:0,parent_category_id:null}),[ei,en]=(0,r.useState)({title:"",description:"",category_id:0,start_date:"",end_date:"",phase:"Planning",status:"not_started",planned_budget:0,actual_spending:0,completion_percentage:0,priority:"medium",team_leader_id:0,team_member_ids:[],color:"#FFB333"}),[er,eo]=(0,r.useState)([]),[el,ed]=(0,r.useState)(""),[ea,es]=(0,r.useState)(null),[ep,ec]=(0,r.useState)(!1),[ex,eg]=(0,r.useState)(null),[eh,eu]=(0,r.useState)([]),[em,ef]=(0,r.useState)([]),[ey,eb]=(0,r.useState)(!1),[ev,ej]=(0,r.useState)(new Set),[e_,ew]=(0,r.useState)(["Planning","Design","Development","Testing","Launch","Maintenance"]);(0,r.useEffect)(()=>{let e=()=>W(window.innerWidth<768);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{if(!i){if(!t){d.push("/login");return}ek()}},[t,i,d]),(0,r.useEffect)(()=>{y&&(eS(),eC(),eD(),eB())},[y]);let eB=async()=>{if(y)try{let{data:e,error:t}=await m.from("timeline_folder_members").select("user_id").eq("folder_id",y.id);if(t)throw t;let i=(null==e?void 0:e.map(e=>e.user_id))||[];if(0===i.length){ef([]);return}let{data:n,error:r}=await m.from("auth_user").select("id, name, email").in("id",i).eq("is_active",!0).order("name",{ascending:!0});!r&&n&&ef(n)}catch(e){console.error("Error fetching team members:",e)}},eE=async e=>{es(e);try{let{data:t,error:i}=await m.from("timeline_item_checklist").select("*").eq("timeline_item_id",e.id).order("item_order",{ascending:!0});!i&&t?eu(t):eu([])}catch(e){console.error("Error loading checklist:",e),eu([])}eb(!0)},ek=async()=>{try{var t;S(!0);let i=parseInt((null==e?void 0:null===(t=e.id)||void 0===t?void 0:t.toString())||"0"),{data:n,error:r}=await m.from("timeline_folder_members").select("folder_id").eq("user_id",i);if(r)throw r;let o=(null==n?void 0:n.map(e=>e.folder_id))||[],{data:l,error:d}=await m.from("timeline_folders").select("*").or("created_by_id.eq.".concat(i,",id.in.(").concat(o.join(",")||"0",")")).eq("is_active",!0).order("created_at",{ascending:!1});if(d)throw d;f(l||[]),l&&l.length>0&&!y&&b(l[0])}catch(e){console.error("Error fetching folders:",e),D("Failed to load timeline folders")}finally{S(!1)}},eS=async()=>{if(y)try{let{data:e,error:t}=await m.from("timeline_categories").select("*").eq("folder_id",y.id).eq("is_active",!0).order("display_order",{ascending:!0});if(t)throw t;let i=new Map,n=[];if((e||[]).forEach(e=>{i.set(e.id,{...e,subcategories:[]})}),(e||[]).forEach(e=>{let t=i.get(e.id);if(e.parent_category_id){let n=i.get(e.parent_category_id);n&&n.subcategories.push(t)}else n.push(t)}),j(n),e&&e.length>0&&0===ev.size){let t=new Set(e.map(e=>e.id));ej(t)}}catch(e){console.error("Error fetching categories:",e)}},eC=async()=>{if(y)try{let{data:e,error:t}=await m.from("timeline_items").select("\n          *,\n          timeline_categories (name, color)\n        ").eq("folder_id",y.id).neq("status","cancelled").order("start_date",{ascending:!0});if(t)throw t;let i=(e||[]).map(e=>{var t;return{...e,category_name:null===(t=e.timeline_categories)||void 0===t?void 0:t.name}});w(i)}catch(e){console.error("Error fetching timeline items:",e)}},eD=async()=>{if(y)try{let{data:e,error:t}=await m.from("timeline_folder_members").select("*").eq("folder_id",y.id);if(t)throw t;let i=await Promise.all((e||[]).map(async e=>{let{data:t}=await m.from("auth_user").select("id, name, email").eq("id",e.user_id).single();return{...e,user_name:(null==t?void 0:t.name)||"Unknown",user_email:(null==t?void 0:t.email)||""}}));E(i)}catch(e){console.error("Error fetching folder members:",e),E([])}},eF=async()=>{try{var t,i;if(!G.name.trim()){D("Folder name is required");return}let n={...G,created_by_id:parseInt((null==e?void 0:null===(t=e.id)||void 0===t?void 0:t.toString())||"0"),is_active:!0},{data:r,error:o}=await m.from("timeline_folders").insert([n]).select().single();if(o)throw o;await m.from("timeline_folder_members").insert([{folder_id:r.id,user_id:parseInt((null==e?void 0:null===(i=e.id)||void 0===i?void 0:i.toString())||"0"),role:"owner",can_edit:!0,can_delete:!0,can_manage_members:!0,can_manage_budget:!0}]),f([r,...u]),b(r),q(!1),J({name:"",description:"",start_date:"",end_date:"",total_budget:0,currency:"USD"}),z("Timeline folder created successfully!"),setTimeout(()=>z(""),3e3)}catch(e){console.error("Error creating folder:",e),D("Failed to create folder")}},ez=async()=>{try{if(!y||!ee.name.trim()){D("Category name is required");return}let e=Math.max(...v.map(e=>e.display_order),0),t={folder_id:y.id,name:ee.name,description:ee.description,color:ee.color,responsible_person_id:ee.responsible_person_id||null,parent_category_id:ee.parent_category_id,display_order:e+1,is_active:!0},{data:i,error:n}=await m.from("timeline_categories").insert([t]).select().single();if(n)throw n;eS(),N(!1),et({name:"",description:"",color:"#3B82F6",responsible_person_id:0,parent_category_id:null}),z("Category created successfully!"),setTimeout(()=>z(""),3e3)}catch(e){console.error("Error creating category:",e),D("Failed to create category")}},eA=async()=>{try{var t;if(!y||!ei.title.trim()){D("Title is required");return}let i=ei.description||"";if(er.length>0){let e="\n\nChecklist:\n"+er.map((e,t)=>"".concat(t+1,". ").concat(e)).join("\n");i+=e}let n={folder_id:y.id,category_id:ei.category_id||null,title:ei.title,description:i,color:ei.color,start_date:ei.start_date,end_date:ei.end_date,phase:ei.phase,status:ei.status,planned_budget:ei.planned_budget,actual_spending:ei.actual_spending,completion_percentage:ei.completion_percentage,team_leader_id:ei.team_leader_id||null,team_member_ids:ei.team_member_ids.length>0?ei.team_member_ids:null,priority:ei.priority,created_by_id:parseInt((null==e?void 0:null===(t=e.id)||void 0===t?void 0:t.toString())||"0")},{data:r,error:o}=await m.from("timeline_items").insert([n]).select().single();if(o)throw o;if(er.length>0){let e=er.map((e,t)=>({timeline_item_id:r.id,item_text:e,is_completed:!1,item_order:t}));await m.from("timeline_item_checklist").insert(e)}eC(),U(!1),eW(),z("Timeline item created successfully!"),setTimeout(()=>z(""),3e3)}catch(e){console.error("Error creating timeline item:",e),D("Failed to create timeline item")}},eW=()=>{en({title:"",description:"",category_id:0,start_date:"",end_date:"",phase:"Planning",status:"not_started",planned_budget:0,actual_spending:0,completion_percentage:0,priority:"medium",team_leader_id:0,team_member_ids:[],color:"#FFB333"}),eo([]),ed(""),es(null),ec(!1)},eR=(e,t)=>{let i=new Date(e.start_date),n=new Date(e.end_date),r=0,o=1;if("day"===R){i.setHours(0,0,0,0),n.setHours(0,0,0,0),r=t.findIndex(e=>{let t=new Date(e.date);return t.setHours(0,0,0,0),t.getTime()===i.getTime()});let e=t.findIndex(e=>{let t=new Date(e.date);return t.setHours(0,0,0,0),t.getTime()===n.getTime()});-1!==r&&-1!==e?o=e-r+1:-1!==r?o=t.length-r:-1!==e&&(r=0,o=e+1)}else if("week"===R){r=t.findIndex(e=>{let t=new Date(e.date);return t.setDate(e.date.getDate()+6),i>=e.date&&i<=t});let e=t.findIndex(e=>{let t=new Date(e.date);return t.setDate(e.date.getDate()+6),n>=e.date&&n<=t});-1!==r&&-1!==e&&(o=e-r+1)}else if("month"===R){r=t.findIndex(e=>e.date.getMonth()===i.getMonth()&&e.date.getFullYear()===i.getFullYear());let e=t.findIndex(e=>e.date.getMonth()===n.getMonth()&&e.date.getFullYear()===n.getFullYear());-1!==r&&-1!==e&&(o=e-r+1)}else if("quarter"===R){r=t.findIndex(e=>{let t=Math.floor(i.getMonth()/3),n=Math.floor(e.date.getMonth()/3);return i.getFullYear()===e.date.getFullYear()&&t===n});let e=t.findIndex(e=>{let t=Math.floor(n.getMonth()/3),i=Math.floor(e.date.getMonth()/3);return n.getFullYear()===e.date.getFullYear()&&t===i});-1!==r&&-1!==e&&(o=e-r+1)}return{startCol:Math.max(0,r),spanCols:Math.max(1,o)}},eI=e=>({not_started:"#9CA3AF",in_progress:"#3B82F6",completed:"#10B981",on_hold:"#F59E0B",cancelled:"#EF4444",delayed:"#DC2626"})[e]||"#9CA3AF";if(i||k)return(0,n.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",background:"white"},children:(0,n.jsx)("div",{style:{textAlign:"center"},children:(0,n.jsx)("p",{style:{color:"#6B7280",fontSize:"13px"},children:"Loading..."})})});let eM=(()=>{let e=[],t=new Date(M);if("day"===R){t.setHours(0,0,0,0);for(let i=0;i<30;i++){let n=new Date(t);n.setDate(t.getDate()+i),e.push({label:n.toLocaleDateString("en-US",{month:"short",day:"numeric"}),date:n})}}else if("week"===R){let i=new Date(t);i.setDate(t.getDate()-t.getDay());for(let t=0;t<12;t++){let n=new Date(i);n.setDate(i.getDate()+7*t);let r=new Date(n);r.setDate(n.getDate()+6),e.push({label:"".concat(n.toLocaleDateString("en-US",{month:"short",day:"numeric"})," - ").concat(r.toLocaleDateString("en-US",{month:"short",day:"numeric"})),date:n})}}else if("month"===R){t.setDate(1);for(let i=0;i<6;i++){let n=new Date(t);n.setMonth(t.getMonth()+i),e.push({label:n.toLocaleDateString("en-US",{month:"short",year:"numeric"}),date:n})}}else if("quarter"===R){let i=new Date(t.getFullYear(),3*Math.floor(t.getMonth()/3),1);for(let t=0;t<8;t++){let n=new Date(i);n.setMonth(i.getMonth()+3*t);let r=Math.floor(n.getMonth()/3)+1;e.push({label:"Q".concat(r," ").concat(n.getFullYear()),date:n})}}return e})();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{style:{flex:1,padding:A?"16px":"24px",maxWidth:"100%",overflow:"hidden"},children:[(0,n.jsxs)("div",{style:{marginBottom:"24px",borderBottom:"1px solid #E5E7EB",paddingBottom:"16px"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"16px",flexWrap:"wrap",gap:"12px"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{style:{fontSize:A?"20px":"24px",fontWeight:"600",color:"#111827",margin:"0 0 4px 0"},children:"Timeline & Roadmap"}),(0,n.jsx)("p",{style:{color:"#6B7280",margin:0,fontSize:"14px"},children:"Project timeline and task management"})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[(0,n.jsxs)("button",{onClick:()=>q(!0),style:{padding:"8px 16px",background:"white",color:"#374151",border:"1px solid #D1D5DB",borderRadius:"4px",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[(0,n.jsx)(a.Z,{style:{width:"16px",height:"16px"}}),"New Folder"]}),y&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{onClick:()=>N(!0),style:{padding:"8px 16px",background:"white",color:"#374151",border:"1px solid #D1D5DB",borderRadius:"4px",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[(0,n.jsx)(s.Z,{style:{width:"16px",height:"16px"}}),"New Category"]}),(0,n.jsxs)("button",{onClick:()=>U(!0),style:{padding:"8px 16px",background:"white",color:"#374151",border:"1px solid #D1D5DB",borderRadius:"4px",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[(0,n.jsx)(s.Z,{style:{width:"16px",height:"16px"}}),"New Item"]})]})]})]}),u.length>0&&(0,n.jsxs)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap",alignItems:"center",marginBottom:"16px",padding:"12px",background:"#F9FAFB",border:"1px solid #E5E7EB"},children:[(0,n.jsx)("select",{value:(null==y?void 0:y.id)||"",onChange:e=>{let t=u.find(t=>t.id===parseInt(e.target.value));b(t||null)},style:{padding:"6px 12px",border:"1px solid #D1D5DB",fontSize:"13px",background:"white",minWidth:"200px"},children:u.map(e=>(0,n.jsx)("option",{value:e.id,children:e.name},e.id))}),(0,n.jsxs)("div",{style:{display:"flex",gap:"0",border:"1px solid #D1D5DB"},children:[(0,n.jsx)("button",{onClick:()=>I("day"),style:{padding:"6px 12px",background:"day"===R?"#E5E7EB":"white",color:"#374151",border:"none",borderRight:"1px solid #D1D5DB",cursor:"pointer",fontSize:"13px"},children:"Day"}),(0,n.jsx)("button",{onClick:()=>I("week"),style:{padding:"6px 12px",background:"week"===R?"#E5E7EB":"white",color:"#374151",border:"none",borderRight:"1px solid #D1D5DB",cursor:"pointer",fontSize:"13px"},children:"Week"}),(0,n.jsx)("button",{onClick:()=>I("month"),style:{padding:"6px 12px",background:"month"===R?"#E5E7EB":"white",color:"#374151",border:"none",borderRight:"1px solid #D1D5DB",cursor:"pointer",fontSize:"13px"},children:"Month"}),(0,n.jsx)("button",{onClick:()=>I("quarter"),style:{padding:"6px 12px",background:"quarter"===R?"#E5E7EB":"white",color:"#374151",border:"none",cursor:"pointer",fontSize:"13px"},children:"Quarter"})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"0",border:"1px solid #D1D5DB"},children:[(0,n.jsx)("button",{onClick:()=>{let e=new Date(M);"day"===R?e.setDate(e.getDate()-1):"week"===R?e.setDate(e.getDate()-7):"month"===R?e.setMonth(e.getMonth()-1):e.setMonth(e.getMonth()-3),T(e)},style:{padding:"6px 10px",background:"white",border:"none",borderRight:"1px solid #D1D5DB",cursor:"pointer"},children:(0,n.jsx)(p.Z,{style:{width:"16px",height:"16px",color:"#6B7280"}})}),(0,n.jsx)("button",{onClick:()=>T(new Date),style:{padding:"6px 12px",background:"white",border:"none",borderRight:"1px solid #D1D5DB",fontSize:"13px",cursor:"pointer",color:"#374151"},children:"Today"}),(0,n.jsx)("button",{onClick:()=>{let e=new Date(M);"day"===R?e.setDate(e.getDate()+1):"week"===R?e.setDate(e.getDate()+7):"month"===R?e.setMonth(e.getMonth()+1):e.setMonth(e.getMonth()+3),T(e)},style:{padding:"6px 10px",background:"white",border:"none",cursor:"pointer"},children:(0,n.jsx)(c.Z,{style:{width:"16px",height:"16px",color:"#6B7280"}})})]}),y&&(0,n.jsxs)("button",{onClick:()=>$(!0),style:{padding:"6px 12px",background:"white",color:"#374151",border:"1px solid #D1D5DB",fontSize:"13px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[(0,n.jsx)(x.Z,{style:{width:"14px",height:"14px"}}),"Team (",B.length,")"]}),(0,n.jsxs)("button",{onClick:()=>Q(!0),style:{padding:"6px 12px",background:"white",color:"#374151",border:"1px solid #D1D5DB",fontSize:"13px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[(0,n.jsx)(g.Z,{style:{width:"14px",height:"14px"}}),"Reports"]})]})]}),C&&(0,n.jsxs)("div",{style:{padding:"12px",background:"#FAFAFA",color:"#374151",border:"1px solid #D1D5DB",marginBottom:"16px",fontSize:"13px"},children:[C,(0,n.jsx)("button",{onClick:()=>D(""),style:{float:"right",background:"none",border:"none",cursor:"pointer",color:"#6B7280"},children:"\xd7"})]}),F&&(0,n.jsx)("div",{style:{padding:"12px",background:"#FAFAFA",color:"#374151",border:"1px solid #D1D5DB",marginBottom:"16px",fontSize:"13px"},children:F}),y?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{style:{display:"flex",gap:"24px",marginBottom:"16px",padding:"12px",background:"#F9FAFB",border:"1px solid #E5E7EB",flexWrap:"wrap"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontSize:"11px",color:"#6B7280",marginBottom:"2px",textTransform:"uppercase"},children:"Completion"}),(0,n.jsxs)("div",{style:{fontSize:"20px",fontWeight:"600",color:"#111827"},children:[Math.round(_.reduce((e,t)=>e+t.completion_percentage,0)/(_.length||1)),"%"]}),(0,n.jsxs)("div",{style:{fontSize:"11px",color:"#6B7280"},children:[_.filter(e=>"completed"===e.status).length,"/",_.length," tasks"]})]}),(0,n.jsxs)("div",{style:{borderLeft:"1px solid #E5E7EB",paddingLeft:"24px"},children:[(0,n.jsx)("div",{style:{fontSize:"11px",color:"#6B7280",marginBottom:"2px",textTransform:"uppercase"},children:"Budget"}),(0,n.jsxs)("div",{style:{fontSize:"20px",fontWeight:"600",color:"#111827"},children:["$",_.reduce((e,t)=>e+t.actual_spending,0).toLocaleString()]}),(0,n.jsxs)("div",{style:{fontSize:"11px",color:"#6B7280"},children:["of $",_.reduce((e,t)=>e+t.planned_budget,0).toLocaleString()]})]}),(0,n.jsxs)("div",{style:{borderLeft:"1px solid #E5E7EB",paddingLeft:"24px"},children:[(0,n.jsx)("div",{style:{fontSize:"11px",color:"#6B7280",marginBottom:"2px",textTransform:"uppercase"},children:"Active"}),(0,n.jsx)("div",{style:{fontSize:"20px",fontWeight:"600",color:"#111827"},children:_.filter(e=>"in_progress"===e.status).length}),(0,n.jsx)("div",{style:{fontSize:"11px",color:"#6B7280"},children:"in progress"})]}),(0,n.jsxs)("div",{style:{borderLeft:"1px solid #E5E7EB",paddingLeft:"24px"},children:[(0,n.jsx)("div",{style:{fontSize:"11px",color:"#6B7280",marginBottom:"2px",textTransform:"uppercase"},children:"Status"}),(0,n.jsx)("div",{style:{fontSize:"20px",fontWeight:"600",color:"#111827"},children:_.filter(e=>new Date(e.end_date)>=new Date||"completed"===e.status).length>_.length/2?"On Track":"At Risk"}),(0,n.jsxs)("div",{style:{fontSize:"11px",color:"#6B7280"},children:[_.filter(e=>new Date(e.end_date)<new Date&&"completed"!==e.status).length," overdue"]})]})]}),v.length>0&&(0,n.jsxs)("div",{style:{background:"white",border:"1px solid #E5E7EB",overflowX:"auto"},children:[(0,n.jsx)("div",{style:{padding:"12px",borderBottom:"1px solid #E5E7EB",background:"#F9FAFB"},children:(0,n.jsx)("h2",{style:{fontSize:"14px",fontWeight:"600",margin:0,color:"#374151"},children:"Timeline"})}),(0,n.jsxs)("div",{style:{minWidth:"800px"},children:[(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"250px repeat(".concat(eM.length,", 1fr)"),gap:"0",borderBottom:"2px solid #E5E7EB"},children:[(0,n.jsx)("div",{style:{background:"#F9FAFB",padding:"8px 12px",fontWeight:"600",color:"#111827",fontSize:"12px",borderRight:"1px solid #E5E7EB"},children:"Task"}),eM.map((e,t)=>(0,n.jsx)("div",{style:{background:"#F9FAFB",padding:"8px 12px",textAlign:"center",fontWeight:"500",fontSize:"11px",color:"#6B7280",borderRight:t<eM.length-1?"1px solid #E5E7EB":"none"},children:e.label},t))]}),(()=>{let e=function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=_.filter(e=>e.category_id===t.id);return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"250px repeat(".concat(eM.length,", 1fr)"),gap:"0",borderBottom:"1px solid #E5E7EB"},children:[(0,n.jsxs)("div",{style:{background:"#F9FAFB",padding:"8px 12px",paddingLeft:"".concat(12+20*i,"px"),fontWeight:"600",color:"#111827",fontSize:"13px",display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",borderRight:"1px solid #E5E7EB"},onClick:()=>eg(ex===t.id?null:t.id),children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,n.jsx)("button",{onClick:e=>{e.stopPropagation();let i=new Set(ev);i.has(t.id)?i.delete(t.id):i.add(t.id),ej(i)},style:{background:"none",border:"none",cursor:"pointer",padding:"0",display:"flex",alignItems:"center"},children:ev.has(t.id)?(0,n.jsx)(h.Z,{style:{width:"14px",height:"14px",color:"#6B7280"}}):(0,n.jsx)(c.Z,{style:{width:"14px",height:"14px",color:"#6B7280"}})}),(0,n.jsxs)("span",{children:[i>0?"└ ":"",t.name]})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"6px",alignItems:"center"},children:[(0,n.jsxs)("span",{style:{fontSize:"11px",color:"#6B7280"},children:["(",r.length,")"]}),ex===t.id&&(0,n.jsx)("button",{onClick:async e=>{e.stopPropagation(),confirm('Delete category "'.concat(t.name,'"?'))&&(await m.from("timeline_categories").update({is_active:!1}).eq("id",t.id),eS(),eg(null),z('"'.concat(t.name,'" deleted')))},style:{padding:"2px 8px",background:"white",color:"#374151",border:"1px solid #D1D5DB",cursor:"pointer",fontSize:"11px"},children:"Delete"})]})]}),eM.map((e,t)=>(0,n.jsx)("div",{style:{background:"#FAFAFA",minHeight:"20px",borderRight:t<eM.length-1?"1px solid #E5E7EB":"none"}},t))]}),ev.has(t.id)&&r.map(e=>{let{startCol:t,spanCols:i}=eR(e,eM),r="completed"===e.status;return(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"250px repeat(".concat(eM.length,", 1fr)"),gap:"0",borderBottom:"1px solid #E5E7EB"},children:[(0,n.jsxs)("div",{style:{background:"white",padding:"8px 12px",fontSize:"13px",color:"#374151",display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",borderRight:"1px solid #E5E7EB"},onClick:t=>{t.stopPropagation(),eE(e)},children:[(0,n.jsx)("input",{type:"checkbox",checked:r,onChange:async t=>{t.stopPropagation(),await m.from("timeline_items").update({status:r?"in_progress":"completed",completion_percentage:r?e.completion_percentage:100}).eq("id",e.id),eC()},style:{width:"14px",height:"14px",cursor:"pointer",marginRight:"8px",flexShrink:0}}),(0,n.jsxs)("div",{style:{flex:1},children:[(0,n.jsx)("div",{style:{fontSize:"13px",textDecoration:r?"line-through":"none",color:r?"#9CA3AF":"#111827"},children:e.title}),(0,n.jsxs)("div",{style:{fontSize:"11px",color:"#9CA3AF",marginTop:"2px"},children:[e.completion_percentage,"% • $",e.actual_spending.toLocaleString()]})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"6px",alignItems:"center"},children:[(0,n.jsx)("span",{style:{fontSize:"11px",color:"#6B7280"},children:e.status.replace("_"," ")}),(0,n.jsx)("button",{onClick:async t=>{t.stopPropagation(),confirm('Delete "'.concat(e.title,'"?'))&&(await m.from("timeline_items").delete().eq("id",e.id),eC(),z("Deleted"))},style:{padding:"2px 6px",background:"white",color:"#6B7280",border:"1px solid #D1D5DB",cursor:"pointer",fontSize:"10px"},children:"\xd7"})]})]}),eM.map((r,o)=>(0,n.jsx)("div",{style:{background:"white",position:"relative",minHeight:"40px",borderRight:o<eM.length-1?"1px solid #E5E7EB":"none"},children:o===t&&(0,n.jsx)("div",{style:{position:"absolute",left:"4px",right:i>1?"auto":"4px",width:i>1?"calc(".concat(100*i,"% + ").concat((i-1)*100,"% - 8px)"):"calc(100% - 8px)",top:"50%",transform:"translateY(-50%)",background:"#E5E7EB",height:"20px",border:"1px solid #D1D5DB",cursor:"pointer",zIndex:10,overflow:"hidden"},onClick:()=>{es(e),U(!0)},children:(0,n.jsx)("div",{style:{height:"100%",width:"".concat(e.completion_percentage,"%"),background:"#9CA3AF",transition:"width 0.3s ease"}})})},o))]},e.id)}),t.subcategories&&t.subcategories.length>0&&(0,n.jsx)(n.Fragment,{children:t.subcategories.map(t=>e(t,i+1))})]},t.id)};return v.map(t=>e(t,0))})(),0===v.length&&(0,n.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",background:"#FAFAFA",border:"1px solid #E5E7EB"},children:[(0,n.jsx)("p",{style:{color:"#6B7280",fontSize:"13px",marginBottom:"12px"},children:"No categories yet."}),(0,n.jsx)("button",{onClick:()=>N(!0),style:{padding:"6px 16px",background:"white",color:"#374151",border:"1px solid #D1D5DB",fontSize:"13px",cursor:"pointer"},children:"Create Category"})]})]})]})]}):(0,n.jsxs)("div",{style:{textAlign:"center",padding:"60px 20px",background:"#FAFAFA",border:"1px solid #E5E7EB"},children:[(0,n.jsx)("p",{style:{color:"#6B7280",fontSize:"14px",marginBottom:"16px"},children:"No timeline folders yet"}),(0,n.jsx)("button",{onClick:()=>q(!0),style:{padding:"8px 16px",background:"white",color:"#374151",border:"1px solid #D1D5DB",fontSize:"13px",cursor:"pointer"},children:"Create Folder"})]})]}),O&&(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:()=>q(!1),children:(0,n.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"32px",maxWidth:"600px",width:"90%"},onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("h3",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"24px"},children:"Create Timeline Folder"}),(0,n.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:"Folder Name *"}),(0,n.jsx)("input",{type:"text",value:G.name,onChange:e=>J({...G,name:e.target.value}),placeholder:"e.g., 2025 Company Roadmap",style:{width:"100%",padding:"12px",border:"2px solid #E5E7EB",borderRadius:"8px"}})]}),(0,n.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:"Description"}),(0,n.jsx)("textarea",{value:G.description,onChange:e=>J({...G,description:e.target.value}),rows:3,style:{width:"100%",padding:"12px",border:"2px solid #E5E7EB",borderRadius:"8px"}})]}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"20px"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:"Start Date"}),(0,n.jsx)("input",{type:"date",value:G.start_date,onChange:e=>J({...G,start_date:e.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #E5E7EB",borderRadius:"8px"}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:"End Date"}),(0,n.jsx)("input",{type:"date",value:G.end_date,onChange:e=>J({...G,end_date:e.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #E5E7EB",borderRadius:"8px"}})]})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[(0,n.jsx)("button",{onClick:()=>q(!1),style:{padding:"8px 16px",background:"white",color:"#374151",border:"1px solid #D1D5DB",fontSize:"13px",cursor:"pointer"},children:"Cancel"}),(0,n.jsx)("button",{onClick:eF,style:{padding:"8px 16px",background:"#111827",color:"white",border:"none",fontSize:"13px",cursor:"pointer"},children:"Create"})]})]})}),Z&&(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:()=>N(!1),children:(0,n.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"32px",maxWidth:"500px",width:"90%"},onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("h3",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"24px"},children:"Create Category"}),(0,n.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:"Category Name *"}),(0,n.jsx)("input",{type:"text",value:ee.name,onChange:e=>et({...ee,name:e.target.value}),placeholder:"e.g., Social Media, IT, Marketing",style:{width:"100%",padding:"12px",border:"2px solid #E5E7EB",borderRadius:"8px"}})]}),(0,n.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:"Parent Category (Optional)"}),(0,n.jsxs)("select",{value:ee.parent_category_id||"",onChange:e=>et({...ee,parent_category_id:e.target.value?parseInt(e.target.value):null}),style:{width:"100%",padding:"12px",border:"2px solid #E5E7EB",borderRadius:"8px"},children:[(0,n.jsx)("option",{value:"",children:"None (Main Category)"}),v.map(e=>(0,n.jsxs)("option",{value:e.id,children:["↳ ",e.name]},e.id))]}),(0,n.jsx)("div",{style:{fontSize:"12px",color:"#64748B",marginTop:"4px"},children:"Select a parent to create a subcategory"})]}),(0,n.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:"Description"}),(0,n.jsx)("textarea",{value:ee.description,onChange:e=>et({...ee,description:e.target.value}),rows:2,placeholder:"Optional description...",style:{width:"100%",padding:"12px",border:"2px solid #E5E7EB",borderRadius:"8px"}})]}),(0,n.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:"Color"}),(0,n.jsx)("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:["#F59E0B","#8B5CF6","#10B981","#3B82F6","#EF4444","#EC4899","#F97316","#14B8A6"].map(e=>(0,n.jsx)("button",{onClick:()=>et({...ee,color:e}),style:{width:"40px",height:"40px",borderRadius:"8px",background:e,border:ee.color===e?"3px solid #1F2937":"none",cursor:"pointer"}},e))})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[(0,n.jsx)("button",{onClick:()=>N(!1),style:{padding:"8px 16px",background:"white",color:"#374151",border:"1px solid #D1D5DB",fontSize:"13px",cursor:"pointer"},children:"Cancel"}),(0,n.jsx)("button",{onClick:ez,style:{padding:"8px 16px",background:"#111827",color:"white",border:"none",fontSize:"13px",cursor:"pointer"},children:"Create"})]})]})}),Y&&(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px",overflowY:"auto"},onClick:()=>U(!1),children:(0,n.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"32px",maxWidth:"700px",width:"100%",maxHeight:"90vh",overflowY:"auto"},onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("h3",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"24px"},children:"Create Timeline Item"}),(0,n.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:"Title *"}),(0,n.jsx)("input",{type:"text",value:ei.title,onChange:e=>en({...ei,title:e.target.value}),placeholder:"e.g., Website Redesign Project",style:{width:"100%",padding:"12px",border:"2px solid #E5E7EB",borderRadius:"8px"}})]}),(0,n.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:"Category & Subcategories"}),(0,n.jsxs)("select",{value:ei.category_id,onChange:e=>en({...ei,category_id:parseInt(e.target.value)}),style:{width:"100%",padding:"12px",border:"2px solid #E5E7EB",borderRadius:"8px"},children:[(0,n.jsx)("option",{value:0,children:"Select category..."}),(()=>{let e=function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[];return t.forEach(t=>{let o="  ".repeat(i);r.push((0,n.jsxs)("option",{value:t.id,children:[i>0?o+"└ ":"",t.name]},t.id)),t.subcategories&&t.subcategories.length>0&&(r=r.concat(e(t.subcategories,i+1)))}),r};return e(v)})()]})]}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"20px"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:"Start Date *"}),(0,n.jsx)("input",{type:"date",value:ei.start_date,onChange:e=>en({...ei,start_date:e.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #E5E7EB",borderRadius:"8px"}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:"End Date *"}),(0,n.jsx)("input",{type:"date",value:ei.end_date,onChange:e=>en({...ei,end_date:e.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #E5E7EB",borderRadius:"8px"}})]})]}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"20px"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:"Phase"}),(0,n.jsx)("select",{value:ei.phase,onChange:e=>en({...ei,phase:e.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #E5E7EB",borderRadius:"8px"},children:e_.map(e=>(0,n.jsx)("option",{value:e,children:e},e))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:"Status"}),(0,n.jsxs)("select",{value:ei.status,onChange:e=>en({...ei,status:e.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #E5E7EB",borderRadius:"8px"},children:[(0,n.jsx)("option",{value:"not_started",children:"Not Started"}),(0,n.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,n.jsx)("option",{value:"completed",children:"Completed"}),(0,n.jsx)("option",{value:"on_hold",children:"On Hold"}),(0,n.jsx)("option",{value:"delayed",children:"Delayed"})]})]})]}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"20px"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:"Planned Budget ($)"}),(0,n.jsx)("input",{type:"number",value:ei.planned_budget,onChange:e=>en({...ei,planned_budget:parseFloat(e.target.value)||0}),style:{width:"100%",padding:"12px",border:"2px solid #E5E7EB",borderRadius:"8px"}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:"Actual Spending ($)"}),(0,n.jsx)("input",{type:"number",value:ei.actual_spending,onChange:e=>en({...ei,actual_spending:parseFloat(e.target.value)||0}),style:{width:"100%",padding:"12px",border:"2px solid #E5E7EB",borderRadius:"8px"}})]})]}),(0,n.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"12px",fontWeight:"600"},children:"Assign Team Members"}),(0,n.jsx)("div",{style:{border:"2px solid #E5E7EB",borderRadius:"8px",padding:"16px",background:"#F9FAFB",maxHeight:"200px",overflowY:"auto"},children:em.length>0?em.map(e=>(0,n.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"10px",background:"white",borderRadius:"6px",marginBottom:"8px",cursor:"pointer",border:ei.team_member_ids.includes(e.id)?"2px solid #3B82F6":"2px solid transparent"},children:[(0,n.jsx)("input",{type:"checkbox",checked:ei.team_member_ids.includes(e.id),onChange:t=>{t.target.checked?en({...ei,team_member_ids:[...ei.team_member_ids,e.id]}):en({...ei,team_member_ids:ei.team_member_ids.filter(t=>t!==e.id)})},style:{width:"18px",height:"18px",cursor:"pointer",accentColor:"#3B82F6"}}),(0,n.jsxs)("div",{style:{flex:1},children:[(0,n.jsx)("div",{style:{fontWeight:"600",fontSize:"14px",color:"#374151"},children:e.name}),(0,n.jsx)("div",{style:{fontSize:"12px",color:"#64748B"},children:e.email})]})]},e.id)):(0,n.jsx)("p",{style:{textAlign:"center",color:"#9CA3AF",fontSize:"14px",padding:"20px"},children:"No team members. Add members in Team settings."})})]}),(0,n.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:"Completion % (0-100)"}),(0,n.jsx)("input",{type:"number",min:"0",max:"100",value:ei.completion_percentage,onChange:e=>en({...ei,completion_percentage:parseInt(e.target.value)||0}),style:{width:"100%",padding:"12px",border:"2px solid #E5E7EB",borderRadius:"8px"}})]}),(0,n.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:"Checklist Items"}),(0,n.jsxs)("div",{style:{border:"2px solid #E5E7EB",borderRadius:"8px",padding:"16px",background:"#F9FAFB"},children:[(0,n.jsxs)("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[(0,n.jsx)("input",{type:"text",value:el,onChange:e=>ed(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),el.trim()&&(eo([...er,el]),ed("")))},placeholder:"Add checklist item...",style:{flex:1,padding:"10px",border:"1px solid #D1D5DB",borderRadius:"6px"}}),(0,n.jsx)("button",{type:"button",onClick:()=>{el.trim()&&(eo([...er,el]),ed(""))},style:{padding:"8px 16px",background:"#111827",color:"white",border:"none",fontSize:"13px",cursor:"pointer"},children:"Add"})]}),er.map((e,t)=>(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px",background:"white",borderRadius:"6px",marginBottom:"8px"},children:[(0,n.jsxs)("span",{style:{flex:1,fontSize:"14px"},children:[t+1,". ",e]}),(0,n.jsx)("button",{onClick:()=>eo(er.filter((e,i)=>i!==t)),style:{padding:"2px 8px",background:"white",color:"#6B7280",border:"1px solid #D1D5DB",fontSize:"11px",cursor:"pointer"},children:"\xd7"})]},t))]})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[(0,n.jsx)("button",{onClick:()=>{U(!1),eW()},style:{padding:"8px 16px",background:"white",color:"#374151",border:"1px solid #D1D5DB",fontSize:"13px",cursor:"pointer"},children:"Cancel"}),(0,n.jsx)("button",{onClick:eA,style:{padding:"8px 16px",background:"#111827",color:"white",border:"none",fontSize:"13px",cursor:"pointer"},children:"Create"})]})]})}),H&&y&&(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},onClick:()=>$(!1),children:(0,n.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"32px",maxWidth:"600px",width:"100%",maxHeight:"90vh",overflowY:"auto"},onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("h3",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"24px"},children:"Manage Team Members"}),(0,n.jsx)("div",{style:{marginBottom:"24px"},children:(0,n.jsxs)("div",{style:{display:"flex",gap:"8px",marginBottom:"16px",flexDirection:A?"column":"row"},children:[(0,n.jsx)("input",{type:"email",placeholder:"Enter team member email...",id:"memberEmail",style:{flex:1,padding:"14px 16px",border:"2px solid #E5E7EB",borderRadius:"8px",fontSize:"15px",minWidth:A?"100%":"300px"}}),(0,n.jsxs)("select",{id:"memberRole",style:{padding:"12px",border:"2px solid #E5E7EB",borderRadius:"8px"},children:[(0,n.jsx)("option",{value:"viewer",children:"Viewer"}),(0,n.jsx)("option",{value:"editor",children:"Editor"}),(0,n.jsx)("option",{value:"manager",children:"Manager"})]}),(0,n.jsx)("button",{onClick:async()=>{let e=document.getElementById("memberEmail").value,t=document.getElementById("memberRole").value;if(e.trim())try{let{data:i}=await m.from("auth_user").select("id").eq("email",e).single();i&&(await m.from("timeline_folder_members").insert([{folder_id:y.id,user_id:i.id,role:t,can_edit:"viewer"!==t,can_delete:"manager"===t,can_manage_members:"manager"===t,can_manage_budget:"manager"===t}]),eD(),z("Member added successfully!"),document.getElementById("memberEmail").value="")}catch(e){D("Failed to add member")}},style:{padding:"8px 16px",background:"#111827",color:"white",border:"none",fontSize:"13px",cursor:"pointer"},children:"Add"})]})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"12px"},children:"Current Members"}),B.map(e=>(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px",background:"#FAFAFA",border:"1px solid #E5E7EB",marginBottom:"4px"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontSize:"13px",color:"#111827"},children:e.user_name}),(0,n.jsx)("div",{style:{fontSize:"11px",color:"#6B7280"},children:e.user_email})]}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,n.jsx)("span",{style:{fontSize:"11px",color:"#6B7280"},children:e.role}),"owner"!==e.role&&(0,n.jsx)("button",{onClick:async()=>{confirm("Remove this member?")&&(await m.from("timeline_folder_members").delete().eq("id",e.id),eD())},style:{padding:"2px 8px",background:"white",color:"#6B7280",border:"1px solid #D1D5DB",fontSize:"11px",cursor:"pointer"},children:"\xd7"})]})]},e.id))]}),(0,n.jsx)("div",{style:{marginTop:"24px",display:"flex",justifyContent:"flex-end"},children:(0,n.jsx)("button",{onClick:()=>$(!1),style:{padding:"8px 16px",background:"#111827",color:"white",border:"none",fontSize:"13px",cursor:"pointer"},children:"Done"})})]})}),K&&y&&(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},onClick:()=>Q(!1),children:(0,n.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"32px",maxWidth:"900px",width:"100%",maxHeight:"90vh",overflowY:"auto"},onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("h3",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"24px"},children:"Visual Reports & Analytics"}),(0,n.jsxs)("div",{style:{marginBottom:"24px",padding:"16px",background:"#FAFAFA",border:"1px solid #E5E7EB"},children:[(0,n.jsx)("div",{style:{fontSize:"13px",fontWeight:"600",marginBottom:"8px",color:"#374151"},children:"Total Progress"}),(0,n.jsxs)("div",{style:{fontSize:"24px",fontWeight:"700",color:"#111827",marginBottom:"8px"},children:[Math.round(_.reduce((e,t)=>e+t.completion_percentage,0)/(_.length||1)),"%"]}),(0,n.jsx)("div",{style:{width:"100%",height:"8px",background:"#E5E7EB"},children:(0,n.jsx)("div",{style:{width:"".concat(Math.round(_.reduce((e,t)=>e+t.completion_percentage,0)/(_.length||1)),"%"),height:"100%",background:"#6B7280"}})})]}),(0,n.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,n.jsx)("div",{style:{fontSize:"13px",fontWeight:"600",marginBottom:"12px",color:"#374151"},children:"Budget"}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px"},children:[(0,n.jsxs)("div",{style:{padding:"12px",background:"#FAFAFA",border:"1px solid #E5E7EB"},children:[(0,n.jsx)("div",{style:{fontSize:"11px",color:"#6B7280",marginBottom:"4px"},children:"Planned"}),(0,n.jsxs)("div",{style:{fontSize:"18px",fontWeight:"600",color:"#111827"},children:["$",_.reduce((e,t)=>e+t.planned_budget,0).toLocaleString()]})]}),(0,n.jsxs)("div",{style:{padding:"12px",background:"#FAFAFA",border:"1px solid #E5E7EB"},children:[(0,n.jsx)("div",{style:{fontSize:"11px",color:"#6B7280",marginBottom:"4px"},children:"Actual"}),(0,n.jsxs)("div",{style:{fontSize:"18px",fontWeight:"600",color:"#111827"},children:["$",_.reduce((e,t)=>e+t.actual_spending,0).toLocaleString()]})]}),(0,n.jsxs)("div",{style:{padding:"12px",background:"#FAFAFA",border:"1px solid #E5E7EB"},children:[(0,n.jsx)("div",{style:{fontSize:"11px",color:"#6B7280",marginBottom:"4px"},children:"Variance"}),(0,n.jsxs)("div",{style:{fontSize:"18px",fontWeight:"600",color:"#111827"},children:["$",Math.abs(_.reduce((e,t)=>e+t.actual_spending,0)-_.reduce((e,t)=>e+t.planned_budget,0)).toLocaleString()]})]})]})]}),(0,n.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,n.jsx)("div",{style:{fontSize:"13px",fontWeight:"600",marginBottom:"12px",color:"#374151"},children:"By Category"}),v.map(e=>{let t=_.filter(t=>t.category_id===e.id),i=t.length>0?Math.round(t.reduce((e,t)=>e+t.completion_percentage,0)/t.length):0;return(0,n.jsxs)("div",{style:{marginBottom:"12px",padding:"8px",background:"#FAFAFA",border:"1px solid #E5E7EB"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[(0,n.jsx)("span",{style:{fontSize:"12px",color:"#374151"},children:e.name}),(0,n.jsxs)("span",{style:{fontSize:"12px",fontWeight:"600",color:"#111827"},children:[i,"%"]})]}),(0,n.jsx)("div",{style:{width:"100%",height:"6px",background:"#E5E7EB"},children:(0,n.jsx)("div",{style:{width:"".concat(i,"%"),height:"100%",background:"#9CA3AF"}})}),(0,n.jsxs)("div",{style:{fontSize:"10px",color:"#6B7280",marginTop:"4px"},children:[t.filter(e=>"completed"===e.status).length,"/",t.length," completed"]})]},e.id)})]}),(0,n.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,n.jsx)("div",{style:{fontSize:"13px",fontWeight:"600",marginBottom:"12px",color:"#374151"},children:"Status"}),(0,n.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"8px"},children:["not_started","in_progress","completed","on_hold","delayed"].map(e=>{let t=_.filter(t=>t.status===e).length;return(0,n.jsxs)("div",{style:{padding:"8px",background:"#FAFAFA",border:"1px solid #E5E7EB",textAlign:"center"},children:[(0,n.jsx)("div",{style:{fontSize:"18px",fontWeight:"600",color:"#111827"},children:t}),(0,n.jsx)("div",{style:{fontSize:"10px",color:"#6B7280",marginTop:"2px",textTransform:"capitalize"},children:e.replace("_"," ")})]},e)})})]}),(0,n.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,n.jsx)("button",{onClick:()=>Q(!1),style:{padding:"8px 16px",background:"#111827",color:"white",border:"none",fontSize:"13px",cursor:"pointer"},children:"Close"})})]})}),ey&&ea&&(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},onClick:()=>eb(!1),children:(0,n.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"32px",maxWidth:"700px",width:"100%",maxHeight:"90vh",overflowY:"auto"},onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("h3",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"24px",color:"#1F2937"},children:ea.title}),(0,n.jsxs)("div",{style:{marginBottom:"24px",padding:"16px",background:"#F9FAFB",borderRadius:"8px"},children:[(0,n.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,n.jsx)("span",{style:{fontWeight:"600",color:"#64748B",fontSize:"14px"},children:"Status: "}),(0,n.jsx)("span",{style:{padding:"4px 12px",background:eI(ea.status)+"20",color:eI(ea.status),borderRadius:"12px",fontSize:"13px",fontWeight:"600"},children:ea.status.replace("_"," ")})]}),(0,n.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,n.jsx)("span",{style:{fontWeight:"600",color:"#64748B",fontSize:"14px"},children:"Timeline: "}),(0,n.jsxs)("span",{style:{fontSize:"14px"},children:[new Date(ea.start_date).toLocaleDateString()," - ",new Date(ea.end_date).toLocaleDateString()]})]}),(0,n.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,n.jsx)("span",{style:{fontWeight:"600",color:"#64748B",fontSize:"14px"},children:"Budget: "}),(0,n.jsxs)("span",{style:{fontSize:"14px"},children:["$",ea.actual_spending.toLocaleString()," / $",ea.planned_budget.toLocaleString()]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{style:{fontWeight:"600",color:"#64748B",fontSize:"14px"},children:"Completion: "}),(0,n.jsxs)("span",{style:{fontSize:"14px",fontWeight:"600",color:"#111827"},children:[ea.completion_percentage,"%"]})]})]}),ea.team_member_ids&&ea.team_member_ids.length>0&&(0,n.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,n.jsx)("h4",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"8px",color:"#374151"},children:"Team Members"}),(0,n.jsx)("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:ea.team_member_ids.map(e=>{let t=em.find(t=>t.id===e);return t?(0,n.jsx)("div",{style:{padding:"4px 10px",background:"#FAFAFA",color:"#374151",border:"1px solid #E5E7EB",fontSize:"12px"},children:t.name},e):null})})]}),(0,n.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,n.jsxs)("h4",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"12px"},children:["Checklist (",eh.filter(e=>e.is_completed).length,"/",eh.length," completed)"]}),eh.length>0?(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:eh.map((t,i)=>(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",background:t.is_completed?"#F3F4F6":"white",border:"2px solid #E5E7EB",borderRadius:"8px"},children:[(0,n.jsx)("input",{type:"checkbox",checked:t.is_completed,onChange:async i=>{let n=i.target.checked;try{var r;await m.from("timeline_item_checklist").update({is_completed:n,completed_at:n?new Date().toISOString():null,completed_by_id:n?parseInt((null==e?void 0:null===(r=e.id)||void 0===r?void 0:r.toString())||"0"):null}).eq("id",t.id),eu(e=>e.map(e=>e.id===t.id?{...e,is_completed:n}:e)),eC()}catch(e){console.error("Error updating checklist item:",e)}},style:{width:"20px",height:"20px",cursor:"pointer",flexShrink:0,accentColor:"#10B981"}}),(0,n.jsxs)("span",{style:{flex:1,fontSize:"14px",color:t.is_completed?"#9CA3AF":"#374151",textDecoration:t.is_completed?"line-through":"none",fontWeight:t.is_completed?"400":"500"},children:[i+1,". ",t.item_text]}),t.is_completed&&t.completed_at&&(0,n.jsx)("span",{style:{fontSize:"11px",color:"#6B7280"},children:"Done"})]},t.id||i))}):(0,n.jsx)("p",{style:{textAlign:"center",color:"#9CA3AF",fontSize:"14px",padding:"20px",fontStyle:"italic"},children:"No checklist items for this timeline item"})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[(0,n.jsx)("button",{onClick:()=>eb(!1),style:{padding:"8px 16px",background:"white",color:"#374151",border:"1px solid #D1D5DB",fontSize:"13px",cursor:"pointer"},children:"Close"}),(0,n.jsx)("button",{onClick:()=>{en({title:ea.title,description:ea.description||"",category_id:ea.category_id||0,start_date:ea.start_date,end_date:ea.end_date,phase:ea.phase||"Planning",status:ea.status,planned_budget:ea.planned_budget,actual_spending:ea.actual_spending,completion_percentage:ea.completion_percentage,priority:ea.priority,team_leader_id:ea.team_leader_id||0,team_member_ids:ea.team_member_ids||[],color:ea.color}),eo(eh.map(e=>e.item_text)),ec(!0),eb(!1),U(!0)},style:{padding:"8px 16px",background:"#111827",color:"white",border:"none",fontSize:"13px",cursor:"pointer"},children:"Edit"})]})]})})]})}},3549:function(e,t,i){"use strict";i.r(t),i.d(t,{AuthProvider:function(){return a},useAuth:function(){return d}});var n=i(7437),r=i(2265),o=i(8411);let l=(0,r.createContext)(void 0),d=()=>{let e=(0,r.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},a=e=>{let{children:t}=e,[i,d]=(0,r.useState)(null),[a,s]=(0,r.useState)(!0),[p,c]=(0,r.useState)(!1);(0,r.useEffect)(()=>{c(!0)},[]),(0,r.useEffect)(()=>{if(!p)return;let e=async()=>{try{console.log("Starting auth initialization..."),await new Promise(e=>setTimeout(e,50));let{user:r,error:l}=await o.supabaseAuth.getUser();if(console.log("Auth result:",{currentUser:r,error:l}),r&&!l){var e,t,i,n;let o={id:r.id,email:r.email,name:(null===(e=r.user_metadata)||void 0===e?void 0:e.name)||r.email,phone:(null===(t=r.user_metadata)||void 0===t?void 0:t.phone)||"",role:(null===(i=r.user_metadata)||void 0===i?void 0:i.role)||"member",position:(null===(n=r.user_metadata)||void 0===n?void 0:n.position)||"",date_joined:new Date().toISOString()};d(o),console.log("User set:",o)}else console.log("No user found or error occurred")}catch(e){console.error("Auth initialization error:",e)}finally{console.log("Setting isLoading to false"),s(!1)}},t=setTimeout(()=>{console.warn("Auth initialization timeout, proceeding without auth"),s(!1)},3e3),i=setTimeout(()=>{e().finally(()=>{clearTimeout(t)})},100);return()=>{clearTimeout(t),clearTimeout(i)}},[p]);let x=async(e,t)=>{try{console.log("Attempting login for:",e);let{user:a,error:s}=await o.supabaseAuth.signIn(e,t);if(s)throw console.error("Login error:",s),Error(s instanceof Error?s.message:"Login failed");if(a){var i,n,r,l;let e={id:a.id,email:a.email,name:(null===(i=a.user_metadata)||void 0===i?void 0:i.name)||a.email,phone:(null===(n=a.user_metadata)||void 0===n?void 0:n.phone)||"",role:(null===(r=a.user_metadata)||void 0===r?void 0:r.role)||"member",position:(null===(l=a.user_metadata)||void 0===l?void 0:l.position)||"",date_joined:new Date().toISOString()};d(e),console.log("Login successful:",e)}}catch(e){throw console.error("Login failed:",e),Error(e.message||"Login failed")}},g=async e=>{throw Error("Registration is disabled. Please contact an administrator.")},h=async()=>{try{await o.supabaseAuth.signOut(),d(null)}catch(e){console.error("Logout error:",e),d(null)}};return(0,n.jsx)(l.Provider,{value:{user:i,isLoading:a,login:x,register:g,logout:h,isAuthenticated:!!i},children:t})}},622:function(e,t,i){"use strict";var n=i(2265),r=Symbol.for("react.element"),o=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,d=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function s(e,t,i){var n,o={},s=null,p=null;for(n in void 0!==i&&(s=""+i),void 0!==t.key&&(s=""+t.key),void 0!==t.ref&&(p=t.ref),t)l.call(t,n)&&!a.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===o[n]&&(o[n]=t[n]);return{$$typeof:r,type:e,key:s,ref:p,props:o,_owner:d.current}}t.Fragment=o,t.jsx=s,t.jsxs=s},7437:function(e,t,i){"use strict";e.exports=i(622)},4033:function(e,t,i){e.exports=i(94)},654:function(e,t,i){"use strict";var n=i(2265);let r=n.forwardRef(function({title:e,titleId:t,...i},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},i),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))});t.Z=r},4164:function(e,t,i){"use strict";var n=i(2265);let r=n.forwardRef(function({title:e,titleId:t,...i},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},i),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))});t.Z=r},13:function(e,t,i){"use strict";var n=i(2265);let r=n.forwardRef(function({title:e,titleId:t,...i},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},i),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))});t.Z=r},3217:function(e,t,i){"use strict";var n=i(2265);let r=n.forwardRef(function({title:e,titleId:t,...i},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},i),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))});t.Z=r},1205:function(e,t,i){"use strict";var n=i(2265);let r=n.forwardRef(function({title:e,titleId:t,...i},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},i),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"}))});t.Z=r},5255:function(e,t,i){"use strict";var n=i(2265);let r=n.forwardRef(function({title:e,titleId:t,...i},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},i),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))});t.Z=r},9649:function(e,t,i){"use strict";var n=i(2265);let r=n.forwardRef(function({title:e,titleId:t,...i},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},i),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))});t.Z=r}},function(e){e.O(0,[7708,8411,2971,2472,1744],function(){return e(e.s=6098)}),_N_E=e.O()}]);